<html><head><title>SQL Scripts</title>
<meta Name="description"
Content="We provide a Library of free SQL Scripts.">
<meta Name="keywords" Content="SQL SCripts">
</head>

<body text="#202020"><script>#</script>

<html><head><title>Careers Page</title><meta charset="UTF-8"></head>

<body text="#202020">

<table width=100%>
<tr>
<td align=left valign=middle>
<img alt="Database Answers Header" height=58 width=400 src="../images/dba_400_home.jpg">
</td>
<td align=right height=95 rowspan=2 valign=middle>
<img alt="Rhuddlan Castle, North Wales" height=85 width=266 src="../images/welsh_castle_sml.jpg">
</td>
</tr>

<tr>
<td align=left valign=middle>
<img alt="SQL Scripts" height=19 width=120 src="../images/buttons/button_studio/sql_scripts_on.gif">
</td>
</tr>

</table>

<table bgcolor="#0000FF" width=100%>
<tr>
<td align=left colspan=1 valign=TOP width=40>
<a href="../index.html"><img alt="Home" border=0 src="../images/buttons/button_studio/home.gif"></a>
</td>
<td align=left valign=top width=100>
<a href="../ask_a_question_rbw.php3">
<img alt="Ask a Question" border=0 src="../images/buttons/button_studio/ask_a_question.gif"></a>
</td>
<td align=left valign=top width=85>
<a href="../data_models/index.html">
<img alt="Data Models" border=0 src="../images/buttons/button_studio/data_models.gif"></a>
</td><td align=left valign=top width=50>
<a href="../faqs.html"><img alt="FAQs" border=0 src="../images/buttons/button_studio/faqs.gif"></a>
</td>
<td align=left valign=top width=50>
<a href="../search.html"><img alt="Search" border=0 src="../images/buttons/button_studio/search.gif"></a>
</td><td align=left valign=top width=62>
<a href="../site_map.html"><img alt="Site Map" border=0 src="../images/buttons/button_studio/site_map.gif"></a></td>
<td align=right valign=top><font color=white face="Verdana" size="1">&nbsp</td>
</tr>

</table>

<font color=blue face=Verdana size=2>
<!-- end Standard Header - Version 3-->

<!-- begin body Text -->

<table bgcolor="#98CEFD" width=100%>
<tr>
<td align=left valign=top>
<img alt="Chateau in Loire Valley" height=150 width=92 src="../images/chateau_loire_sml.jpg"></a>
</td>

<td>
<font color=blue face=Verdana size=2>We have <a href="other_scripts.html">another Page</a> of links to Scripts available from
from other Web Sites,with some overlap, or you can Search for a particular Script ...
<!-- Atomz.com Search HTML for KPI Systems -->
<form method="get" action="http://search.atomz.com/search/">
<input size=15 name="sp-q">&nbsp;&nbsp<input type=submit value="Search">
<input type=hidden name="sp-a" value="00011467-sp00000000"></form>

<center>
<table border=0 cellpadding=5 width=80%>
<tr>
<td align=middle bgcolor="blue"><b><font color=white>CATEGORY</td>
<td align=middle bgcolor="blue"><b><font color=white>DESCRIPTION</td>
</tr>

<tr>
<td bgcolor="#003088"><font color=white size=2>Auto-Increment</td>
<td bgcolor="#003088" valign=TOP>
<a href="ora_sequence.html">
<font color=white size=2>Shows use of Oracle Sequence for auto-increment.</font></a>
</td>
</tr>

<tr>
<td bgcolor="#003088"><font color=white size=2>Date & Time</td>
<td bgcolor="#003088" valign=TOP>

<a href="#CHECK_DATE"><font color=white size=2>Check Date and Time in SQL in Oracle Report Format.</font></a></td>
</tr>

<tr>
<td bgcolor="#003088"><font color=white size=2>Data Analysis</td>
<td bgcolor="#003088" valign=TOP>
<a href="1chkonrs.html"><font color=white size=2>1. Check Table Owners.</a>
</td>
</tr>

<tr>
<td bgcolor="#003088"><font color=white size=2>Data Analysis</td>
<td bgcolor="#003088" valign=TOP>
<a href="2chkrows.html"><font color=white size=2>2. Check Row Counts.</a>
</td>
</tr>

<tr>
<td bgcolor="#003088"><font color=white size=2>Data Analysis</td>
<td bgcolor="#003088" valign=TOP>
<a href="3chkkeys.html"><font color=white size=2>3. Check Primary Keys.</a>
</td>
</tr>

<tr>
<td bgcolor="#003088"><font color=white size=2>Data Analysis</td>
<td bgcolor="#003088" valign=TOP>
<a href="tbl_defs.html"><font color=white size=2>Print definitions of the Tables in the Database.</font></a>
</td>
</tr>

<tr>
<td bgcolor="#003088"><font color=white size=2>Data Analysis</td>
<td bgcolor="#003088" valign=TOP>
<a href="tbl_defs.html#TABLE_DEFS_OUTPUT"><font color=white size=2>Sample Output for Database Report.</a>
</td>
</tr>

<tr>
<td bgcolor="#003088"><font color=white size=2>Data Analysis</td>
<td bgcolor="#003088" valign=TOP>
<a href="tbl_spcs.html"><font color=white size=2>Check Table Spaces.</a>
</td>
</tr>

<tr>
<td bgcolor="#003088"><font color=white size=2>Data Analysis</td>
<td bgcolor="#003088" valign=TOP>
<a href="#GEN_ANALYZE"><font color=white size=2>Generate SQL to Analyze Record Count Statistics.</a></font></td>
</tr>

<tr>
<td bgcolor="#003088"><font color=white size=2>Data Analysis</td>
<td bgcolor="#003088" valign=TOP>
<a href="#GEN_CHECK"><font color=white size=2>Generate SQL to Check for specific data values.</a>
</td>
</tr>

<tr>
<td bgcolor="#003088"><font color=white size=2>Data Analysis</td>
<td bgcolor="#003088" valign=TOP>
<a href="#WHERE_USED"><font color=white size=2>Where a specific Column is used in Tables.</a>
</td>
</tr>

<tr>
<td bgcolor="#003088"><font color=white size=2>Data Analysis</td>
<td bgcolor="#003088" valign=TOP>
<a href="#GEN_DELETE"><font color=white size=2>Generate SQL to Delete data.</a>
</td>
</tr>

<tr>
<td bgcolor="#003088"><font color=white size=2>Performance</td>
<td bgcolor="#003088" valign=TOP>
<font color=white size=2>Analyze Stats - Oracle Optimizer needs this.</td>
</tr>

<tr>
<td bgcolor="#003088"><font color=white size=2>Trigger</td>
<td bgcolor="#003088" valign=TOP>
<a href="chk_trigger.html">
<font color=white size=2>Check Trigger Definition</a> - Bypasses limits on LONG fields</font></td>
</tr>

<tr>
<td bgcolor="#003088"><font color=white size=2>Users</td>
<td bgcolor="#003088" valign=TOP>
<a href="#CHANGE_USER"><font color=white size=2>Change User in SQLPLUS Session.</a></font></td>
</tr>

<tr>
<td bgcolor="#003088"><font color=white size=2>Users</td>
<td bgcolor="#003088" valign=TOP>
<a href="#CHECK_USER"><font color=white size=2>Check User in SQLPLUS.</a></font></td>
</tr>

</table>

</center>

</table>

<hr>

<a name="CHANGE_USER"></a>
<font color=red>To change User in SQLPLUS Session ...</font>
<li>rem connect login/password, for example ...
<li>connect scott/tiger;
<br>Then, to check the results ...
<li>show user;

<br><br><font color=red>1b. To change Schema to a different User in SQLPLUS Session ...</font>
<li>rem ALTER SESSION SET CURRENT_SCHEMA="USER_ID", for example ...
<li>ALTER SESSION SET CURRENT_SCHEMA="scott";
<br>Note that the Schema Name must be a vaid User.

<br><br><a href="#TOP"><img border=0 src="images/top.gif">Back to the Top</a>

<a name="CHECK_DATE"></a>
<hr><font color=red>Check the Date and Time in </font><font color=green>Oracle Report Format...</font>
<br>set linesize 132
<br>column todays_date format a20 heading 'Todays date'
<br>select TO_CHAR(SysDate,'DD/Mon/YYYY  HH:MI P.M.') todays_date from dual;


<a name="CHECK_USER"></a>
<hr><font color=red>To check the User in SQLPLUS Session ...</font>
<li>show user;


<a name="GEN_ANALYZE"></a>
<hr><font color=red>4a. Generate SQL to Estimate Record Counts ...</font>
<pre>
set feedback off
set heading off
spool analyze_all_tables.sql
rem
SELECT 'ANALYZE TABLE '||' '||Table_name||' ESTIMATE STATISTICS;'
FROM all_tables
WHERE owner='scott';
spool off
quit
</pre>

<hr><font color=red>4b. Sample Output from the Generated SQL ...</font>
<pre>
spool analyze_stats.op
set echo on;
set feedback off;
set heading off;
ANALYZE TABLE  scott.SUBCONTRACT_DAYS ESTIMATE STATISTICS;
ANALYZE TABLE  scott.SUBCONTRACT_NOMINATIONS ESTIMATE STATISTICS;
ANALYZE TABLE  scott.SUBCONTRACT_OPTIONS ESTIMATE STATISTICS;
ANALYZE TABLE  scott.SUBCONTRACT_RAMP_RATES ESTIMATE STATISTICS;
ANALYZE TABLE  scott.SUBCONTRACT_TARIFFS ESTIMATE STATISTICS;
ANALYZE TABLE  scott.SUBCONTRACT_TERMS ESTIMATE STATISTICS;
ANALYZE TABLE  scott.SUBTERMINALS ESTIMATE STATISTICS;
... ditto ...
</pre>


<a name="GEN_CHECK"></a>
<hr><font color=red>To Generate SQL to check values for a specified Field...</font>
<li>After the SQL is generated, use edit/tpu(vi) and Global replace LIKE "LIKE 'SW%' ;"
<pre>
EMA024::ORACLE $ cat gen_chk_mts_id_data.sql
Rem Filename : gen_chk_mts_id_data.sql
rem Function : Generate SQL to check for Test Data values for a specific fld
rem          : wherever that field,(or something like it) appears.
spool  chk_mts_id_data.sql
set echo off;
rem column min_date format a20 heading 'Min Date'
set linesize 132;
select name FROM V$DATABASE;
show user;
select TO_CHAR(SysDate,'DD/Mon/YYYY HH:MI P.M.') from dual;
rem
SELECT DISTINCT 'SELECT DISTINCT ' || column_name || ' FROM ' || table_name ||
' WHERE mts_id LIKE '
FROM   all_tab_columns
WHERE  column_name LIKE '%MTS_ID%'
AND    table_name  NOT LIKE 'BARRY%'
AND    table_name  NOT LIKE '%TMP'
AND    table_name  NOT LIKE '%VIEW%'
AND    table_name  NOT LIKE 'Y2K%' ;
rem
spool off;
quit;
</pre>

<hr><a href="#TOP"><img border=0 src="images/top.gif">Back to the Top</a>


<a name="GEN_DELETE"></a>
<hr><font color=red>To Generate SQL to delete values for a specified Field...</font>
<li>After the SQL is generated, use edit/tpu(vi) and Global replace LIKE "LIKE 'SW%' ;"
<pre>

DISK$APPL01:[ORACLE.BARRYS.SCRIPTS.MTRS]GEN_DEL_MTR_DATA.SQL;4

Rem Filename : gen_del_mts_id_data.sql
spool  del_mts_id_data.sql
set echo off;
rem column min_date format a20 heading 'Min Date'
set linesize 132;
select name FROM V$DATABASE;
show user;
select TO_CHAR(SysDate,'DD/Mon/YYYY HH:MI P.M.') from dual;
rem
SELECT DISTINCT 'DELETE FROM ' || table_name ||
' WHERE ' || column_name || ' LIKE '
FROM   all_tab_columns
WHERE  column_name LIKE '%MTS_ID%'
AND    table_name  NOT LIKE 'BARRY%'
AND    table_name  NOT LIKE '%TMP'
AND    table_name  NOT LIKE '%VIEW%'
AND    table_name  NOT LIKE 'Y2K%' ;
rem
spool off;
quit;
</pre>

<hr><a href="#TOP"><img border=0 src="images/top.gif">Back to the Top</a>

<a name="WHERE_USED">
<hr><font color=red>To Find Tables Where a specific Column is used from System Catalogues...</font>
<pre>
{xxx009}oracle# cat da_utilities/chk_where_used.sql
rem Filename  : chk_where_used.sql
rem Function  : Find Tables where a specified Column is used.
rem Directory : y2k/scott_export_data/mitch/
rem Author    : Barry Williams
rem
rem Step 1) Find the Table Owner ...*/
spool chk_where_used.op
set heading off;
rem SELECT owner,count(*) FROM all_tables GROUP BY owner;
rem
SELECT   DISTINCT  table_name,column_name
FROM     all_tab_columns
WHERE    column_name LIKE '%AGREE%'
OR       column_name LIKE '%ANN%'
OR       column_name LIKE '%STOR%'
OR       table_name  LIKE '%AGREE%'
OR       table_name  LIKE '%ANN%'
OR       table_name  LIKE '%STOR%'
ORDER    BY table_name,column_name;
rem
spool off
quit
{xxx009}oracle#
</pre>

<hr><a href="#TOP"><img border=0 src="images/top.gif">Back to the Top</a>

<a name="TABLE_DEFS">
<hr><font color=red>10. Print Table Definitions, (i.e. Database Definition) ...</font>
<pre>
HOSTNAME::ORACLE $ cat dd_step4b.sql
rem Filename : dd_step4b.sql
rem Note     : This Version is for IFMS and prints only the
rem          : 'Data' Tables, which begin with FMS_TD_
rem
SELECT name FROM V$DATABASE;
SHOW USER;
spool dd_step4b.op
select TO_CHAR(SysDate,'DD/Mon/YYYY HH:MI P.M.') from dual;
rem
rem set heading off;
rem
set termout  on
set feedback OFF
set verify off
set pagesize 59
set linesize 132
set newpage  0
set space    1
set recsep off
set arraysize 5
rem
rem column COL_COMMENT format a40  word_wrap
column TABLE_NAME  format a30 HEADING   'TABLE NAME'
column KEY_SEQ     format 99  heading  'KEY'
column COLUMN_ID   format 999  heading  'ID'
column COLUMN_NAME format a30  heading  'FIELD NAME'
column TYPE_LENGTH format a15   heading  'DATA TYPE'
rem column CODED_TYPE  format a8   heading  'LENGTH'
rem column DATA_SCALE  format 9    heading  'DEC'
column LENGTH      format 9999 heading  'LENGTH'
column NULLABLE    format a5   heading  'NULL?'
rem
column TODAY       noprint   new_value   date_var
column USER        noprint   new_value   user_var
rem
break on TABLE_NAME SKIP 2
rem
ttitle left 'Date: ' 30th. April 2000 -
center 'IFMS - Tables and Columns  in the FMSPRD1  Database' -
  skip 2
rem  right  'Page ' format 99  SQL.PNO -
rem  skip 2
rem
rem spool chk_table_defs.op
rem
SELECT   table_name,key_seq
        ,column_id,column_name
        ,data_type || '(' || TO_CHAR(length) || ')'  type_length
        ,data_scale
        ,nullable
FROM     barrys_dd2x
WHERE    table_name LIKE 'FMS_TD_%'
ORDER BY table_name, key_seq,column_id;
rem
set termout on
rem
spool off;
quit;
HOSTNAME::ORACLE $
</pre>

<br><br><a href="#TOP"><img border=0 src="images/top.gif">Back to the Top</a>
<!-- Start of Standard Footer -->
<hr size=3>

<table border=0 width=80%>
<tr>
<td align=middle>
<font face="Verdana" size=1>
        [ <a href="../index.html">Home Page</a>
        | <a href="../ask_a_question.html">Ask me a Question</a>
        | <a href="../contact_us.html">Contact Us</a>
        | <a href="../a_day_in_the_life.html">The Life of a DBA</a>
<!---   | <a href="mailto:dba@kpisystems.com">Email</a> --->
        | <a href="../faqs.html">FAQs</a>
        | <a href="../search.html">Search</a>
        | <a href="../site_map.html">Site Map</a> ]
</font>
</td>
</tr>
</table>

<hr size=3>
<!-- End of  Standard Footer -->
<center><font size=1><I> &#169  Database Answers Ltd. 2001</I></font></center>

</body>

</html>


